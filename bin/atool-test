#!/usr/bin/env node

var program = require('commander');
var cwd = process.cwd();

program
  .version(require('../package').version, '-v, --version')
  .option('-p, --port <n>', 'server port. Default: 9876')
  .option('--no-chai', 'run tests with custom assert library')
  .option('--no-coverage', 'without coverage')
  .option('-k, --keep', 'keep process after tests')
  .option('--config <path>', 'custom config path, default is webpack.config.js')
  .parse(process.argv);

require('../lib')({
  port: program.port || '9876',
  chai: program.chai,
  keep: program.keep,
  coverage: program.coverage,
  config: program.config || 'webpack.config.js'
}, function(code) {
  process.exit(code);
});

require('atool-monitor').emit();